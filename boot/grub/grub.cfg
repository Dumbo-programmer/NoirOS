# GRUB Configuration for NoirOS - Enhanced Version

# Timeout and default
set timeout=8
set default=0

# Color scheme - Dark theme with cyan/purple accents
set color_normal=white/black
set color_highlight=black/cyan

# Menu colors
set menu_color_normal=white/black
set menu_color_highlight=black/cyan

# Background & terminal
terminal_output console
set gfxmode=auto
set gfxpayload=keep
# Optional background image (uncomment if available)
# background_image /boot/grub/noirbg.png
# Optional custom font
# loadfont /boot/grub/fonts/unicode.pf2

# Function: Display loading messages
function boot_message {
    echo "================================"
    echo "   Booting NoirOS Kernel..."
    echo "   Initializing subsystems..."
    echo "   File system, UI, and devices"
    echo "================================"
}

# ------------------------------
# Main NoirOS Boot Menu
# ------------------------------
menuentry "NoirOS - Main System" --class noiros --class os {
    boot_message
    multiboot /boot/kernel.elf
    echo "NoirOS started successfully!"
    read
}

# Debug/Recovery Submenu
submenu "NoirOS - Recovery, Debug" {
    menuentry "Debug Mode (Verbose)" --class debug {
        echo "Loading NoirOS in debug mode..."
        echo "Verbose output enabled"
        multiboot /boot/kernel.elf debug
    }

    menuentry "Safe Mode" --class safe {
        echo "Loading NoirOS in safe mode..."
        echo "Minimal drivers and UI loaded"
        multiboot /boot/kernel.elf safe
    }
}

# Utilities Submenu
submenu "System Utilities" {
    # Memory test
    menuentry "Memory Test (memtest86plus)" --class memtest {
        echo "Launching memory test utility..."
        linux16 /boot/memtestiso
    }

    # System info
    menuentry "System Information" --class info {
        echo "=== NoirOS System Info ==="
        echo "Kernel: NoirOS Custom Kernel"
        echo "Features: File Browser, Text Editor, Snake Game"
        echo "Architecture: x86 (32-bit)"
        echo "Boot Method: Multiboot"
        echo "Press any key to return..."
        read
    }
}

# Separator for menu clarity
menuentry "──────────────────────────────" { true }

# Power options
menuentry "Reboot System" --class reboot {
    echo "Rebooting system..."
    reboot
}

menuentry "Shutdown System" --class halt {
    echo "Shutting down system..."
    halt
}

# Keyboard hint footer
insmod gfxterm
echo "Use arrows to navigate, Enter to select, Esc to go back"
